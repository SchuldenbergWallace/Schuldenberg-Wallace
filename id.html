<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>5L-IDCARDS</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap');
        @import url('https://fonts.googleapis.com/css2?family=Alex+Brush&family=Inter:wght@100&display=swap');
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@100;300;500;700&display=swap');
        
        body {
            font-family: Inter, sans-serif;
            -webkit-font-smoothing: antialiased;
            box-sizing: border-box;
            text-align: center;
            color: #fff;
            background-color: #0f0f10;
            margin: 0;
            padding: 0;
        }

        #um-idcard {
            width: 43vh;
            height: auto;
            border-radius: 1.3vh;
            display: flex;
            box-shadow: 0 4px 8px 0 rgba(0, 0, 0, .2), 0 6px 20px 0 rgba(0, 0, 0, .19);
            flex-direction: column;
            align-items: center;
            text-transform: uppercase;
            color: #000;
            margin: 3vh auto;
            background-color: rgb(235, 247, 253);
        }

        .header {
            display: flex;
            align-items: center;
            font-size: 2vh;
            font-weight: 500;
            letter-spacing: 2px;
            padding: .5vh;
            border-bottom: 1px solid #0000001f;
        }

        .header img {
            width: 3.5vh;
            margin-left: -1.2vh;
            margin-top: 1vh;
        }

        .header span {
            margin: 0 .5vh;
        }

        .content {
            display: flex;
            width: 100%;
        }

        .icon {
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        #mugshot_display {
            width: 10vh;
            height: 10vh;
            border-radius: .8vh;
            border: .1vh solid rgba(0, 0, 0, .19);
            background-color: #000; /* Sfondo nero */
        }

        .text {
            flex: 1.6;
            display: flex;
            flex-direction: column;
            align-items: flex-end;
            padding: 1.5vh;
        }

        .text ul {
            width: 100%;
        }

        .text ul li {
            display: flex;
            justify-content: space-between;
            list-style-type: none;
            font-size: 1.2vh;
            font-weight: 900;
            border-bottom: .1vh solid rgba(0, 0, 0, .07);
            padding: .3vh 0;
        }

        .text ul span.info {
            font-size: 1vh;
            font-weight: 800;
            padding-left: 2vh;
        }

        .footer {
            display: flex;
            width: 100%;
            padding: 5px;
        }

        .signature {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: flex-start;
            margin-left: 4vh;
            font-family: 'Alex Brush', cursive;
            text-transform: capitalize;
            font-weight: 700;
            font-size: 1.5vh;
        }

        .flagsandimg img {
            width: 16px;
            height: 16px;
            opacity: .8;
        }

        #smallmugshot_display {
            filter: grayscale(1);
            border-radius: 40px;
        }

        .flagsandimg {
            flex: 1;
            display: flex;
            flex-direction: row-reverse;
            margin-right: 2vh;
            justify-content: revert;
        }
    </style>
</head>
<body>

    <h1>5L-IDCARDS (credits to alp1x for the base) </h1>
    
    <form id="id-card-form">
        <label for="nome">Nome:</label>
        <input type="text" id="nome" value="Litto"><br>

        <label for="cognome">Cognome:</label>
        <input type="text" id="cognome" value="Litto"><br>

        <label for="dob">Data di Nascita:</label>
        <input type="text" id="dob" value="20.10.2024"><br>

        <label for="sesso">Sesso:</label>
        <input type="text" id="sesso" value="M"><br>

        <label for="nazionalita">Nazionalità:</label>
        <input type="text" id="nazionalita" value="LOS SANTOS"><br>

        <label for="firma">Firma:</label>
        <input type="text" id="firma" value="LittoLitto"><br>

        <label for="mugshot">Carica foto:</label>
        <input type="file" id="mugshot" accept="image/*" onchange="handleImageUpload()"><br><br>

        <button type="button" onclick="updateCard()">Aggiorna Carta d'Identità</button>
        <button type="button" onclick="downloadCard()">Scarica Carta d'Identità</button>
        <button type="button" onclick="uploadToImgbb()">Carica su imgbb</button>
        <button type="button" onclick="transformToPDA()">PDA</button>
        <button type="button" onclick="transformToPAT()">PAT</button>
		<button type="button" onclick="transformToCDI()">CDI</button>
    </form>

    <div id="um-idcard">
        <div class="header">
            <span id="lang_header">FIVE LIVES</span>
            <span id="cardtype">CARTA D'IDENTITÀ</span>
        </div>
        <div class="content">
            <div class="icon">
                <img id="mugshot_display" src="" alt="Foto">
            </div>
            <div class="text">
                <ul>
                    <li><span>Cognome:</span> <span id="Cognome_display">Litto</span></li>
                    <li><span>Nome:</span> <span id="Nome_display">Litto</span></li>
                    <li><span>Data di Nascita:</span> <span id="Dob_display">20.10.2024</span></li>
                    <li><span>Sesso:</span> <span id="Sesso_display">M</span></li>
                    <li><span>Nazionalità:</span> <span id="Nazionalità_display">LOS SANTOS</span></li>
                </ul>
            </div>
        </div>
        <div class="footer">
            <div class="signature" id="Firma_display">
                LittoLitto
            </div>
            <div class="flagsandimg">
                <img id="flag" src="32.png" alt="Bandiera">
                <img id="smallmugshot_display" src="" alt="Piccola Foto">
            </div>
        </div>
    </div>

    <script>
        async function handleImageUpload() {
            const mugshotInput = document.getElementById('mugshot');
            if (mugshotInput.files && mugshotInput.files[0]) {
                const reader = new FileReader();
                reader.onload = async function(e) {
                    const originalImage = e.target.result;

                    // Rimuovi sfondo
                    const imgBlob = await fetch(originalImage).then(res => res.blob());
                    const formData = new FormData();
                    formData.append('image_file', imgBlob);
                    formData.append('size', 'auto');

                    const removeBgResponse = await fetch('https://api.remove.bg/v1.0/removebg', {
                        method: 'POST',
                        headers: {
                            'X-Api-Key': 's8R6a7ZZ8pxBwPtW9D69nvZM',
                        },
                        body: formData,
                    });

                    if (removeBgResponse.ok) {
                        const bgRemovedBlob = await removeBgResponse.blob();
                        const bgRemovedImageUrl = URL.createObjectURL(bgRemovedBlob);
                        document.getElementById('mugshot_display').src = bgRemovedImageUrl;
                        document.getElementById('smallmugshot_display').src = bgRemovedImageUrl;
                    } else {
                        alert('Errore nel rimuovere lo sfondo dell\'immagine.');
                    }
                };
                reader.readAsDataURL(mugshotInput.files[0]);
            }
        }

        function updateCard() {
            const nome = document.getElementById('nome').value;
            const cognome = document.getElementById('cognome').value;
            const dob = document.getElementById('dob').value;
            const sesso = document.getElementById('sesso').value;
            const nazionalita = document.getElementById('nazionalita').value;
            const firma = document.getElementById('firma').value;

            document.getElementById('Nome_display').textContent = nome;
            document.getElementById('Cognome_display').textContent = cognome;
            document.getElementById('Dob_display').textContent = dob;
            document.getElementById('Sesso_display').textContent = sesso;
            document.getElementById('Nazionalità_display').textContent = nazionalita;
            document.getElementById('Firma_display').textContent = firma;
        }

        function downloadCard() {
            const card = document.getElementById('um-idcard');
            html2canvas(card).then(canvas => {
                const link = document.createElement('a');
                link.href = canvas.toDataURL('image/png');
                link.download = 'id_card.png';
                link.click();
            });
        }

        function uploadToImgbb() {
            const canvas = document.createElement('canvas');
            const context = canvas.getContext('2d');
            const card = document.getElementById('um-idcard');
            canvas.width = card.offsetWidth;
            canvas.height = card.offsetHeight;

            html2canvas(card).then(canvas => {
                const imageData = canvas.toDataURL('image/png');
                const formData = new FormData();
                formData.append('image', imageData);

                fetch('https://api.imgbb.com/1/upload?key=2970b606faf3351a85bd7467ab5efd5b', {
                    method: 'POST',
                    body: formData,
                })
                .then(response => response.json())
                .then(data => {
                    console.log('Immagine caricata su imgbb:', data);
                    alert('Immagine caricata con successo!');
                })
                .catch(error => {
                    console.error('Errore nel caricamento dell\'immagine:', error);
                });
            });
        }

          function transformToPDA() {
            document.getElementById('um-idcard').style.backgroundColor = '#c7ffe5';
            document.getElementById('lang_header').textContent = 'FIVE LIVES';
            document.getElementById('cardtype').textContent = 'PORTO D\'ARMI';
        }
		function transformToPAT() {
            document.getElementById('um-idcard').style.backgroundColor = '#fbbbbb';
            document.getElementById('lang_header').textContent = 'FIVE LIVES';
            document.getElementById('cardtype').textContent = 'PATENTE DI GUIDA';
        }
			function transformToCDI() {
            document.getElementById('um-idcard').style.backgroundColor = '#ebf3fb';
            document.getElementById('lang_header').textContent = 'FIVE LIVES';
			document.getElementById('cardtype').textContent = 'CARTA D\'IDENTITÀ';
			
        }
    </script>

</body>
</html>
